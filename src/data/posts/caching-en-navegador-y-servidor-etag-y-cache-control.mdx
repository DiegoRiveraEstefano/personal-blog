---
slug: "caching-en-navegador-y-servidor-etag-y-cache-control"
title: "Caching en Navegador y Servidor: ETag y Cache-Control"
description: Explicaci√≥n t√©cnica sobre caching en navegador y servidor, enfoc√°ndose en ETag y Cache-Control.
publishDate: 2023-10-01
tags: ["desarrollo-web", "performance"]
author: Diego Rivera
---


# Caching en Navegador y Servidor: ETag y Cache-Control

El **caching HTTP** es una de las t√©cnicas m√°s efectivas para mejorar el rendimiento web. Permite que los navegadores reutilicen recursos previamente descargados (im√°genes, hojas de estilo, scripts, documentos JSON, etc.) sin tener que pedirlos nuevamente al servidor en cada visita.

Los beneficios principales son:

* **Reducci√≥n de carga en el servidor** ‚Üí menos solicitudes completas.
* **Aceleraci√≥n en visitas recurrentes** ‚Üí los usuarios descargan solo lo estrictamente necesario.
* **Menor uso de ancho de banda** ‚Üí ahorro en infraestructura y mejor experiencia m√≥vil.

---

## Caching a nivel de navegador

El navegador mantiene una copia local de los recursos descargados. Cuando el usuario vuelve a visitar la p√°gina:

* Si el recurso sigue siendo v√°lido (seg√∫n pol√≠ticas de cach√©), se reutiliza directamente desde el almacenamiento local.
* Si no est√° seguro de su validez, consulta al servidor con cabeceras condicionales (ej. `If-None-Match`, `If-Modified-Since`).

Esto evita descargar archivos id√©nticos en cada request.

---

## Caching a nivel de servidor

El servidor es el que decide cu√°nto tiempo un recurso puede considerarse v√°lido y c√≥mo el navegador debe verificarlo. Esto se hace enviando **cabeceras HTTP de control de cach√©**.

Las m√°s comunes son:

1. **Cache-Control** ‚Üí instrucci√≥n expl√≠cita sobre c√≥mo almacenar y reutilizar el recurso.
2. **ETag** ‚Üí identificador √∫nico del recurso (hash, checksum, versi√≥n).
3. **Last-Modified** ‚Üí fecha de √∫ltima modificaci√≥n del recurso.

---

## Cache-Control

La cabecera `Cache-Control` define pol√≠ticas de expiraci√≥n y reutilizaci√≥n. Algunos ejemplos:

```http
Cache-Control: max-age=31536000, public
```

* `max-age=31536000` ‚Üí el recurso puede almacenarse durante 1 a√±o (en segundos).
* `public` ‚Üí cualquier cach√© (navegador, proxy, CDN) puede guardarlo.

Otros valores √∫tiles:

* `no-cache` ‚Üí el recurso debe verificarse con el servidor antes de usarse.
* `no-store` ‚Üí no se debe almacenar en cach√© (ej. respuestas sensibles).
* `must-revalidate` ‚Üí obliga a validar una vez expirado el tiempo.

Ejemplo pr√°ctico: los archivos est√°ticos con nombres versionados (`app.v123.js`) suelen servirse con cach√© de un a√±o, porque el nombre cambia cuando se actualizan.

---

## ETag

La cabecera `ETag` funciona como un **identificador √∫nico** de un recurso, normalmente un hash generado a partir de su contenido.

Ejemplo de respuesta del servidor:

```http
ETag: "abc123"
Cache-Control: max-age=0, must-revalidate
```

En la siguiente visita, el navegador enviar√°:

```http
If-None-Match: "abc123"
```

Si el archivo no ha cambiado, el servidor responde con:

```http
304 Not Modified
```

üëâ El navegador reutiliza el archivo local sin volver a descargarlo completo, ahorrando ancho de banda y tiempo.

---

## Estrategia combinada

La pr√°ctica m√°s com√∫n es combinar **Cache-Control** y **ETag**:

1. **Archivos est√°ticos versionados (CSS, JS, im√°genes):**

   * `Cache-Control: max-age=31536000, immutable`
   * As√≠, el navegador los guarda durante un a√±o y nunca los revalida.
   * Cuando cambia el archivo, tambi√©n cambia su nombre (`main.abc123.js`), forzando una nueva descarga.

2. **Archivos din√°micos o sin versionado (HTML, API JSON):**

   * `Cache-Control: no-cache`
   * `ETag` activado.
   * As√≠, el navegador consulta al servidor si ha cambiado antes de descargarlo.

---

## Ejemplo en Nginx

```nginx
location /static/ {
    expires 1y;
    add_header Cache-Control "public, immutable";
}

location /api/ {
    add_header Cache-Control "no-cache";
    etag on;
}
```

---

## Conclusi√≥n

* **Cache-Control** define la estrategia de almacenamiento (tiempo de vida, validez, reglas).
* **ETag** permite validar si un recurso cambi√≥ sin necesidad de descargarlo nuevamente.
* La combinaci√≥n de ambos reduce significativamente la carga del servidor y acelera la experiencia de usuario en visitas recurrentes.

En la pr√°ctica:

* **Versiona tus archivos est√°ticos** y usa `Cache-Control: immutable`.
* **Activa ETags o Last-Modified** para contenido din√°mico que cambia con el tiempo.

De esta forma, aseguras que los navegadores descarguen **solo lo que realmente ha cambiado**.

---

¬øQuieres que prepare tambi√©n un **diagrama visual del ciclo de cach√©** (primer request ‚Üí validaci√≥n condicional ‚Üí uso de cach√© local) para complementar este art√≠culo?
